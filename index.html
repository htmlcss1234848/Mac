<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FluxMAC Validator</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Cyberpunk Theme Colors */
:root {
    --bg-color: #050505;
    --panel-bg: #0a0a0a;
    --neon-blue: #00f3ff;
    --neon-green: #00ff9d;
    --neon-red: #ff0055;
    --text-color: #e0e0e0;
}

body {
    background-color: var(--bg-color);
    background-image: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000 100%);
    color: var(--text-color);
    font-family: 'Courier New', monospace;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
}

.glass-panel {
    background: rgba(10, 10, 10, 0.8);
    border: 1px solid #333;
    border-radius: 10px;
    padding: 30px;
    width: 400px;
    box-shadow: 0 0 20px rgba(0, 243, 255, 0.1);
    backdrop-filter: blur(10px);
}

.neon-text {
    text-align: center;
    color: var(--neon-blue);
    text-shadow: 0 0 10px var(--neon-blue);
    margin-bottom: 30px;
    letter-spacing: 2px;
}

.input-group { margin-bottom: 20px; }
label { display: block; font-size: 0.8rem; color: #888; margin-bottom: 5px; }

input[type="text"] {
    width: 100%;
    background: #111;
    border: 1px solid #333;
    color: var(--neon-blue);
    padding: 12px;
    border-radius: 4px;
    box-sizing: border-box;
    font-family: monospace;
    outline: none;
    transition: border 0.3s;
}
input[type="text"]:focus { border-color: var(--neon-blue); box-shadow: 0 0 5px rgba(0,243,255,0.3); }

.cyber-btn {
    width: 100%;
    padding: 15px;
    background: transparent;
    border: 1px solid var(--neon-blue);
    color: var(--neon-blue);
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.cyber-btn:hover { background: var(--neon-blue); color: black; box-shadow: 0 0 15px var(--neon-blue); }
.cyber-btn:disabled { border-color: #555; color: #555; cursor: not-allowed; box-shadow: none; }

.loading { text-align: center; margin-top: 20px; color: #ffeb3b; animation: blink 1s infinite; }

.result-card {
    margin-top: 25px;
    border-top: 1px solid #333;
    padding-top: 20px;
}
.status-header { font-size: 1.2rem; text-align: center; margin-bottom: 15px; font-weight: bold; }
.active { color: var(--neon-green); text-shadow: 0 0 10px var(--neon-green); }
.inactive { color: var(--neon-red); text-shadow: 0 0 10px var(--neon-red); }

.info-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; }
.highlight { color: #ffeb3b; }

.m3u-box { margin-top: 20px; }
.m3u-box input { font-size: 0.7rem; margin-bottom: 5px; }
.copy-btn {
    width: 100%;
    background: #222;
    border: 1px solid #444;
    color: white;
    padding: 5px;
    cursor: pointer;
}
.copy-btn:hover { background: #333; }

@keyframes blink { 50% { opacity: 0.5; } }
    </style>
</head>
<body>

    <div class="glass-panel">
        <h2 class="neon-text">FLUX MAC VALIDATOR</h2>
        
        <div class="input-group">
            <label>PORTAL URL</label>
            <input type="text" id="host" placeholder="http://example.com:8080/c/">
        </div>

        <div class="input-group">
            <label>MAC ADDRESS</label>
            <input type="text" id="mac" placeholder="00:1A:79:XX:XX:XX" maxlength="17">
        </div>

        <button onclick="checkMac()" id="btn" class="cyber-btn">VALIDATE ACCESS</button>

        <div id="loading" class="loading" style="display: none;">SCANNING PORTAL...</div>

        <div id="result" class="result-card" style="display: none;">
            <div id="statusHeader" class="status-header"></div>
            <div class="info-row">
                <span>Expiry:</span> <span id="expiry" class="highlight"></span>
            </div>
            <div class="info-row">
                <span>Created:</span> <span id="created"></span>
            </div>
            
            <div class="m3u-box">
                <label>Generated M3U Link:</label>
                <input type="text" id="m3uLink" readonly>
                <button onclick="copyM3U()" class="copy-btn">COPY</button>
            </div>
        </div>
    </div>

    <script>
        // MAC Auto Formatter
document.getElementById('mac').addEventListener('input', function (e) {
    let target = e.target;
    let input = target.value.replace(/[^A-Fa-f0-9]/g, "").substring(0, 12);
    let formatted = "";
    for (let i = 0; i < input.length; i++) {
        if (i > 0 && i % 2 === 0) formatted += ":";
        formatted += input[i];
    }
    target.value = formatted.toUpperCase();
});

async function checkMac() {
    const host = document.getElementById('host').value.trim();
    const mac = document.getElementById('mac').value.trim();
    const resultDiv = document.getElementById('result');
    const loadingDiv = document.getElementById('loading');
    const btn = document.getElementById('btn');

    if (!host || !mac) return alert("Please fill all fields");

    // UI Reset
    btn.disabled = true;
    loadingDiv.style.display = 'block';
    resultDiv.style.display = 'none';

    try {
        const response = await fetch('/api/check', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ host, mac })
        });

        const data = await response.json();

        loadingDiv.style.display = 'none';
        resultDiv.style.display = 'block';

        const statusHeader = document.getElementById('statusHeader');
        
        if (data.success) {
            statusHeader.innerHTML = "ACCESS GRANTED ‚úÖ";
            statusHeader.className = "status-header active";
            
            document.getElementById('expiry').innerText = data.data.expiry;
            document.getElementById('created').innerText = data.data.created;
            document.getElementById('m3uLink').value = data.data.m3u;
        } else {
            statusHeader.innerHTML = "ACCESS DENIED ‚ùå";
            statusHeader.className = "status-header inactive";
            document.getElementById('expiry').innerText = "N/A";
            document.getElementById('created').innerText = "N/A";
            document.getElementById('m3uLink').value = "No Playlist Available";
        }

    } catch (err) {
        loadingDiv.style.display = 'none';
        alert("Server Error: Check your connection");
    } finally {
        btn.disabled = false;
    }
}

function copyM3U() {
    const copyText = document.getElementById("m3uLink");
    copyText.select();
    document.execCommand("copy");
    alert("M3U Link Copied! üìã");
}
    </script>
</body>
</html>
