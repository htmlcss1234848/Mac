<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV Deep Scanner</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
    background-color: #0b0f19;
    color: #fff;
    font-family: 'Segoe UI', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
}
.container {
    background: #151b2b;
    padding: 25px;
    border-radius: 12px;
    width: 100%;
    max-width: 450px;
    box-shadow: 0 0 20px rgba(0, 150, 255, 0.1);
    border: 1px solid #1f293a;
}
h2 { text-align: center; color: #3b82f6; margin-top: 0; }

input {
    width: 100%;
    padding: 12px;
    background: #0b0f19;
    border: 1px solid #1f293a;
    color: #fff;
    border-radius: 6px;
    margin-bottom: 15px;
    box-sizing: border-box;
}
button {
    width: 100%;
    padding: 12px;
    background: #3b82f6;
    border: none;
    color: white;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
}
button:hover { background: #2563eb; }

/* Result Section */
.result-box { margin-top: 20px; border-top: 1px solid #1f293a; padding-top: 15px; }
.status-text { text-align: center; font-size: 1.2rem; margin-bottom: 15px; font-weight: bold; }
.active { color: #10b981; }
.error { color: #ef4444; }

.info-grid {
    display: flex;
    justify-content: space-between;
    background: #0b0f19;
    padding: 10px;
    border-radius: 6px;
    margin-bottom: 15px;
    font-size: 0.9rem;
}

.content-section { margin-bottom: 15px; }
.content-section h4 { margin: 5px 0 8px 0; color: #94a3b8; font-size: 0.9rem; }

/* Badges for Categories */
.tags { display: flex; flex-wrap: wrap; gap: 5px; }
.badge {
    background: #1e293b;
    color: #cbd5e1;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 0.75rem;
    border: 1px solid #334155;
}

.m3u-area { display: flex; gap: 5px; margin-top: 20px; }
.m3u-area input { margin: 0; font-size: 0.8rem; }
.m3u-area button { width: 30%; font-size: 0.8rem; background: #334155; }

 /* ‡¶Ü‡¶ó‡ßá‡¶∞ CSS ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶è‡¶á ‡¶Ö‡¶Ç‡¶∂‡¶ü‡ßÅ‡¶ï‡ßÅ ‡¶∞‡¶ø‡¶™‡ßç‡¶≤‡ßá‡¶∏ ‡¶¨‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® */

.detail-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* ‡¶¶‡ßÅ‡¶á ‡¶ï‡¶≤‡¶æ‡¶Æ */
    gap: 10px;
    background: #0f172a;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    border: 1px solid #334155;
}

.detail-item {
    font-size: 0.85rem;
    color: #94a3b8;
    border-bottom: 1px solid #1e293b;
    padding-bottom: 5px;
}

.detail-item.full-width {
    grid-column: span 2; /* ‡¶™‡ßÅ‡¶∞‡ßã ‡¶≤‡¶æ‡¶á‡¶® ‡¶ú‡ßÅ‡ßú‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
}

.val {
    color: #38bdf8; /* ‡¶π‡¶æ‡¶á‡¶≤‡¶æ‡¶á‡¶ü ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ */
    font-weight: bold;
    float: right;
}

.status-text { text-align: center; font-size: 1.2rem; margin-bottom: 15px; font-weight: bold; }
.active { color: #22c55e; text-shadow: 0 0 10px rgba(34, 197, 94, 0.3); }
.error { color: #ef4444; }

/* ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ï‡¶ø CSS ‡¶†‡¶ø‡¶ï ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
    </style>
</head>
<body>

    <div class="container">
        <h2>üöÄ Ultimate MAC Scanner</h2>
        
        <div class="input-group">
            <label>Portal URL</label>
            <input type="text" id="host" placeholder="http://portal.example.com:8080/c/">
        </div>

        <div class="input-group">
            <label>MAC Address</label>
            <input type="text" id="mac" placeholder="00:1A:79:XX:XX:XX" maxlength="17">
        </div>

        <button onclick="checkMac()" id="btn">SCAN FULL INFO</button>

        <div id="result" class="result-box" style="display: none;">
            <div id="status" class="status-text"></div>

            <div class="detail-grid">
                <div class="detail-item"><span>üìÖ Expire:</span> <span id="expiry" class="val"></span></div>
                <div class="detail-item"><span>üìÖ Created:</span> <span id="created" class="val"></span></div>
                
                <div class="detail-item"><span>üë§ Username:</span> <span id="username" class="val"></span></div>
                <div class="detail-item"><span>üîë Password:</span> <span id="password" class="val"></span></div>
                
                <div class="detail-item"><span>üîû Adult Pass:</span> <span id="adult_pass" class="val"></span></div>
                <div class="detail-item"><span>‚öôÔ∏è Settings Pass:</span> <span id="settings_pass" class="val"></span></div>

                <div class="detail-item"><span>üè∑Ô∏è Tariff ID:</span> <span id="tariff_id" class="val"></span></div>
                <div class="detail-item"><span>üì¶ Plan Name:</span> <span id="plan_name" class="val"></span></div>
                
                <div class="detail-item"><span>üåê Max Online:</span> <span id="max_online" class="val"></span></div>
                <div class="detail-item"><span>üì∫ STB Type:</span> <span id="stb_type" class="val"></span></div>
                
                <div class="detail-item"><span>üåç Country:</span> <span id="country" class="val"></span></div>
                <div class="detail-item full-width"><span>üí¨ Comment:</span> <span id="comment" class="val"></span></div>
            </div>

            <div class="content-section">
                <h4>üì° Live Categories</h4>
                <div id="liveList" class="tags">Scanning...</div>
            </div>

            <div class="content-section">
                <h4>üé¨ Movies</h4>
                <div id="vodList" class="tags">Scanning...</div>
            </div>

            <div class="m3u-area">
                <input type="text" id="m3uLink" readonly>
                <button onclick="copyM3U()">Copy Link</button>
            </div>
        </div>
    </div>

    <script>
        // Auto Format MAC
document.getElementById('mac').addEventListener('input', function(e) {
    let val = e.target.value.replace(/[^A-Fa-f0-9]/g, "").substring(0, 12);
    let formatted = val.match(/.{1,2}/g)?.join(":") || val;
    e.target.value = formatted.toUpperCase();
});

async function checkMac() {
    const host = document.getElementById('host').value.trim();
    const mac = document.getElementById('mac').value.trim();
    const resultBox = document.getElementById('result');
    const btn = document.getElementById('btn');

    if(!host || !mac) return alert("Missing Host or MAC");

    btn.innerText = "Fetching Details...";
    btn.disabled = true;
    resultBox.style.display = 'none';

    try {
        const response = await fetch('/api/check', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ host, mac })
        });
        const data = await response.json();

        resultBox.style.display = 'block';
        const statusEl = document.getElementById('status');
        
        if (data.success) {
            statusEl.innerText = "‚úÖ ACCOUNT ACCESS GRANTED";
            statusEl.className = "status-text active";
            
            // Map Data to UI
            const d = data.data;
            setText('expiry', d.expiry);
            setText('created', d.created);
            setText('username', d.username);
            setText('password', d.password);
            setText('adult_pass', d.adult_pass);
            setText('settings_pass', d.settings_pass);
            setText('tariff_id', d.tariff_id);
            setText('plan_name', d.plan_name);
            setText('max_online', d.max_online);
            setText('stb_type', d.stb_type);
            setText('country', d.country);
            setText('comment', d.comment);

            document.getElementById('m3uLink').value = d.m3u;

            // Render Lists
            renderList('liveList', d.liveCategories);
            renderList('vodList', d.vodCategories);
        } else {
            statusEl.innerText = "‚ùå " + data.message;
            statusEl.className = "status-text error";
        }

    } catch (error) {
        alert("Error: " + error.message);
    } finally {
        btn.innerText = "SCAN FULL INFO";
        btn.disabled = false;
    }
}

function setText(id, text) {
    const el = document.getElementById(id);
    if(el) el.innerText = text || 'N/A';
}

function renderList(elementId, items) {
    const el = document.getElementById(elementId);
    if (!items || items.length === 0) {
        el.innerHTML = '<span style="color: #555; font-size: 0.8rem;">Empty</span>';
        return;
    }
    el.innerHTML = items.map(item => `<span class="badge">${item}</span>`).join('');
}

function copyM3U() {
    const copyText = document.getElementById("m3uLink");
    copyText.select();
    document.execCommand("copy");
    alert("Copied!");
}
    </script>
</body>
</html>
